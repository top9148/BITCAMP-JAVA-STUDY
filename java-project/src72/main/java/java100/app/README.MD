## ver 72
- 게시글에 첨부파일 붙이는 기능을 추가하라!
- 학습목표
  - 멀티파트 형식으로 업로드 파일을 처리하는 방법을 익힌다.
  - 게시글에 첨부 파일을 등록하고 삭제하는 방법을 익힌다.
  - 게시글의 첨부파일을 가져오는 다양한 방법을 익힌다.
  - 게시글을 삭제할 때 첨부파일 테이블의 데이터를 자동으로 삭제하는 방법을 익힌다.

## 작업 목록 

### 첨부 파일 경로를 저장할 테이블을 만든다. 
- ex_file 테이블을 정의한다.
- 이 테이블에 게시글 번호를 저장할 외부키 컬럼을 선언한다.
- "bitcamp-java-docs/bitcamp-java-project-v72.sql" 참조하라.

### 입력폼에 파일 항목을 추가한다.
- <input type="file"> 추가
- <form>의 enctype 속성 값을 "multipart/form-data"로 변경

### 파일 업로드 관련 객체를 스프링 설정 파일에 등록한다.
- dispatch-servlet.xml 에 multipartResolver 객체를 추가한다.

### 파일 업로드 관련 의존 라이브러리를 설정한다.
- build.gradle 파일에 의존 라이브러리 정보를 등록한다.
- mvnrepository.com에서 "commons-fileupload"을 검색한다.
- build.gradle 파일에 추가한 후 "gradle eclipse"를 실행한다.
- 프로젝트를 "refresh" 한다.

### 페이지 컨트롤러에서 업로드 파일을 받아 저장한다.
- 파일 데이터가 있을 경우 새 파일명으로 저장한다.

### 업로드 파일 정보를 저장할 도메인 클래스를 만든다.
- java100.app.domain.UploadFile 클래스 작성

### Board 클래스에 첨부 파일 정보를 저장할 수 있도록 필드를 추가한다.
- UploadFile 목록을 저장할 files 필드 추가 

### 페이지 컨트롤러 변경
- 게시물을 저장할 때 업로드 파일이름도 함께 저장하도록 변경한다.

### BoardService 구현체 변경
- 첨부파일 이름을 저장할 수 있도록 변경한다.

### FileDao 인터페이스 생성
- 파일을 insert할 때 사용할 FileDao를 준비한다.
- FileDao가 사용할 SQL Mapper 파일(FileDao.xml)을 준비한다.

## 첨부파일을 가져오는 방법
### 방법1
- BoardDao를 사용하여 게시글을 먼저 가져온다.
- FileDao를 사용하여 그 게시글의 첨부파일 데이터를 가져온다.
### 방법2
- BoardDao에서 게시판 테이블과 첨부파일 테이블을 조인하여 데이터를 가져온다.

## 첨부파일을 삭제하는 방법
### 방법1
- FileDao를 사용하여 그 게시글의 첨부파일을 먼저 지운다.
- BoardDao를 사용하여 게시글을 지운다.
### 방법2
- BoardDao를 사용하여 게시글을 지우면 첨부파일 테이블의 데이터가 자동으로 지워지게 한다.
- 대신 첨부파일 테이블을 정의할 때 참조하는 부모 테이블의 데이터가 지워질 때 자도으로 이 테이블의 데이터도 지우라고 설정해야 한다.


















